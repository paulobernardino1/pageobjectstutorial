# üéØ Tutorial: Page Objects com Cypress

> **Organize seus testes de forma profissional e elimine c√≥digo duplicado**

## üìã O que voc√™ vai aprender

- O que s√£o Page Objects e por que usar
- Como estruturar testes Cypress de forma organizada
- Eliminar duplica√ß√£o de c√≥digo
- Criar comandos customizados reutiliz√°veis
- Manter testes f√°ceis de atualizar

## üõ†Ô∏è Pr√©-requisitos

- Node.js instalado
- Cypress b√°sico
- Conhecimento de JavaScript/seletores CSS

## üö® O Problema

### ‚ùå C√≥digo Desorganizado (Como N√ÉO fazer)

```javascript
// Teste bagun√ßado e duplicado
describe('Login Tests', () => {
  it('Should login successfully', () => {
    cy.visit('https://www.saucedemo.com/')
    cy.get('#user-name').type('standard_user')
    cy.get('#password').type('secret_sauce')
    cy.get('#login-button').click()
    cy.url().should('include', '/inventory')
  })

  it('Should show error for invalid login', () => {
    cy.visit('https://www.saucedemo.com/')
    cy.get('#user-name').type('invalid_user')
    cy.get('#password').type('wrong_password')
    cy.get('#login-button').click()
    cy.get('[data-test="error"]').should('be.visible')
  })
})

describe('Shopping Tests', () => {
  it('Should add product to cart', () => {
    // Repetindo login em todo teste...
    cy.visit('https://www.saucedemo.com/')
    cy.get('#user-name').type('standard_user')
    cy.get('#password').type('secret_sauce')
    cy.get('#login-button').click()
    
    cy.get('[data-test="add-to-cart-sauce-labs-backpack"]').click()
    cy.get('.shopping_cart_badge').should('contain', '1')
  })
})
```

**Problemas:**
- C√≥digo duplicado em todo lugar
- Seletores espalhados pelos testes
- Dif√≠cil de manter quando UI muda
- Testes longos e confusos

## ‚úÖ A Solu√ß√£o: Page Objects

### üìÅ Estrutura do Projeto

```
cypress-page-objects/
‚îú‚îÄ‚îÄ cypress/
‚îÇ   ‚îú‚îÄ‚îÄ e2e/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login.cy.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ shopping.cy.js
‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginPage.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ InventoryPage.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CartPage.js
‚îÇ   ‚îî‚îÄ‚îÄ support/
‚îÇ       ‚îú‚îÄ‚îÄ commands.js
‚îÇ       ‚îî‚îÄ‚îÄ e2e.js
‚îú‚îÄ‚îÄ cypress.config.js
‚îî‚îÄ‚îÄ package.json
```

## üèóÔ∏è Implementa√ß√£o das Page Objects

### 1. LoginPage.js

```javascript
class LoginPage {
  // Seletores organizados
  get usernameField() {
    return cy.get('#user-name')
  }

  get passwordField() {
    return cy.get('#password')
  }

  get loginButton() {
    return cy.get('#login-button')
  }

  get errorMessage() {
    return cy.get('[data-test="error"]')
  }

  // M√©todos de a√ß√£o
  visit() {
    cy.visit('https://www.saucedemo.com/')
    return this
  }

  fillUsername(username) {
    this.usernameField.type(username)
    return this
  }

  fillPassword(password) {
    this.passwordField.type(password)
    return this
  }

  clickLogin() {
    this.loginButton.click()
    return this
  }

  // M√©todo combinado
  login(username, password) {
    this.fillUsername(username)
    this.fillPassword(password)
    this.clickLogin()
    return this
  }

  // Valida√ß√µes
  shouldShowError() {
    this.errorMessage.should('be.visible')
    return this
  }

  shouldRedirectToInventory() {
    cy.url().should('include', '/inventory')
    return this
  }
}

export default LoginPage
```

### 2. InventoryPage.js

```javascript
class InventoryPage {
  get pageTitle() {
    return cy.get('.title')
  }

  get cartBadge() {
    return cy.get('.shopping_cart_badge')
  }

  get cartIcon() {
    return cy.get('.shopping_cart_link')
  }

  // M√©todo din√¢mico para produtos
  getAddToCartButton(productName) {
    return cy.get(`[data-test="add-to-cart-${productName}"]`)
  }

  getRemoveButton(productName) {
    return cy.get(`[data-test="remove-${productName}"]`)
  }

  getProductPrice(productName) {
    return cy.get(`[data-test="inventory-item-${productName}"] .inventory_item_price`)
  }

  // A√ß√µes
  addProductToCart(productName) {
    this.getAddToCartButton(productName).click()
    return this
  }

  removeProductFromCart(productName) {
    this.getRemoveButton(productName).click()
    return this
  }

  goToCart() {
    this.cartIcon.click()
    return this
  }

  // Valida√ß√µes
  shouldHaveTitle(title) {
    this.pageTitle.should('contain', title)
    return this
  }

  shouldShowCartBadge(count) {
    this.cartBadge.should('contain', count.toString())
    return this
  }

  shouldNotShowCartBadge() {
    this.cartBadge.should('not.exist')
    return this
  }
}

export default InventoryPage
```

### 3. CartPage.js

```javascript
class CartPage {
  get cartItems() {
    return cy.get('.cart_item')
  }

  get checkoutButton() {
    return cy.get('#checkout')
  }

  get continueShoppingButton() {
    return cy.get('#continue-shopping')
  }

  getCartItem(productName) {
    return cy.get('.cart_item').contains(productName).parent('.cart_item')
  }

  getRemoveButton(productName) {
    return this.getCartItem(productName).find('button[id*="remove"]')
  }

  // A√ß√µes
  removeItem(productName) {
    this.getRemoveButton(productName).click()
    return this
  }

  proceedToCheckout() {
    this.checkoutButton.click()
    return this
  }

  continueShopping() {
    this.continueShoppingButton.click()
    return this
  }

  // Valida√ß√µes
  shouldHaveItemCount(count) {
    this.cartItems.should('have.length', count)
    return this
  }

  shouldContainProduct(productName) {
    this.getCartItem(productName).should('exist')
    return this
  }

  shouldNotContainProduct(productName) {
    cy.get('.cart_item').contains(productName).should('not.exist')
    return this
  }
}

export default CartPage
```

## üß™ Testes Organizados

### login.cy.js

```javascript
import LoginPage from '../pages/LoginPage'
import InventoryPage from '../pages/InventoryPage'

describe('Login Tests', () => {
  const loginPage = new LoginPage()
  const inventoryPage = new InventoryPage()

  beforeEach(() => {
    loginPage.visit()
  })

  it('Should login successfully with valid credentials', () => {
    loginPage
      .login('standard_user', 'secret_sauce')
      .shouldRedirectToInventory()

    inventoryPage
      .shouldHaveTitle('Products')
  })

  it('Should show error for invalid credentials', () => {
    loginPage
      .login('invalid_user', 'wrong_password')
      .shouldShowError()
  })

  it('Should show error for empty credentials', () => {
    loginPage
      .clickLogin()
      .shouldShowError()
  })
})
```

### shopping.cy.js

```javascript
import LoginPage from '../pages/LoginPage'
import InventoryPage from '../pages/InventoryPage'
import CartPage from '../pages/CartPage'

describe('Shopping Tests', () => {
  const loginPage = new LoginPage()
  const inventoryPage = new InventoryPage()
  const cartPage = new CartPage()

  beforeEach(() => {
    // Usando comando customizado
    cy.loginAsStandardUser()
  })

  it('Should add single product to cart', () => {
    inventoryPage
      .addProductToCart('sauce-labs-backpack')
      .shouldShowCartBadge(1)
  })

  it('Should add multiple products to cart', () => {
    inventoryPage
      .addProductToCart('sauce-labs-backpack')
      .addProductToCart('sauce-labs-bike-light')
      .shouldShowCartBadge(2)
  })

  it('Should remove product from inventory', () => {
    inventoryPage
      .addProductToCart('sauce-labs-backpack')
      .shouldShowCartBadge(1)
      .removeProductFromCart('sauce-labs-backpack')
      .shouldNotShowCartBadge()
  })

  it('Should view cart with added products', () => {
    inventoryPage
      .addProductToCart('sauce-labs-backpack')
      .goToCart()

    cartPage
      .shouldHaveItemCount(1)
      .shouldContainProduct('Sauce Labs Backpack')
  })

  it('Should remove product from cart', () => {
    inventoryPage
      .addProductToCart('sauce-labs-backpack')
      .goToCart()

    cartPage
      .shouldHaveItemCount(1)
      .removeItem('Sauce Labs Backpack')
      .shouldHaveItemCount(0)
  })
})
```

## üõ†Ô∏è Comandos Customizados

### cypress/support/commands.js

```javascript
import LoginPage from '../pages/LoginPage'

// Comando para login r√°pido
Cypress.Commands.add('loginAsStandardUser', () => {
  const loginPage = new LoginPage()
  
  loginPage
    .visit()
    .login('standard_user', 'secret_sauce')
    .shouldRedirectToInventory()
})

Cypress.Commands.add('loginAs', (username, password) => {
  const loginPage = new LoginPage()
  
  loginPage
    .visit()
    .login(username, password)
})

// Comando para adicionar produto via UI
Cypress.Commands.add('addProductToCart', (productName) => {
  cy.get(`[data-test="add-to-cart-${productName}"]`).click()
})

// Comando para limpar carrinho
Cypress.Commands.add('clearCart', () => {
  cy.get('.shopping_cart_link').click()
  
  cy.get('body').then($body => {
    if ($body.find('.cart_item').length > 0) {
      cy.get('.cart_item button[id*="remove"]').each($btn => {
        cy.wrap($btn).click()
      })
    }
  })
})
```

## üéØ Vantagens dos Page Objects

### ‚úÖ Antes vs Depois

| Antes | Depois |
|-------|--------|
| Seletores espalhados | Seletores centralizados |
| C√≥digo duplicado | M√©todos reutiliz√°veis |
| Testes longos | Testes leg√≠veis |
| Dif√≠cil manuten√ß√£o | F√°cil atualiza√ß√£o |
| Acoplamento forte | Baixo acoplamento |

## üöÄ Boas Pr√°ticas

### 1. **M√©todos fluentes (Method Chaining)**
```javascript
loginPage
  .visit()
  .fillUsername('user')
  .fillPassword('pass')
  .clickLogin()
  .shouldRedirectToInventory()
```

### 2. **Separa√ß√£o de responsabilidades**
```javascript
// ‚ùå N√£o fa√ßa
class LoginPage {
  loginAndAddProduct() {
    // Login + a√ß√µes de outra p√°gina
  }
}

// ‚úÖ Fa√ßa
class LoginPage {
  login() {
    // Apenas l√≥gica de login
  }
}
```

### 3. **M√©todos de valida√ß√£o separados**
```javascript
// A√ß√µes
addProductToCart(product) {
  this.getAddButton(product).click()
  return this
}

// Valida√ß√µes
shouldShowCartBadge(count) {
  this.cartBadge.should('contain', count)
  return this
}
```

### 4. **Use dados din√¢micos**
```javascript
const products = ['sauce-labs-backpack', 'sauce-labs-bike-light']

products.forEach(product => {
  it(`Should add ${product} to cart`, () => {
    inventoryPage.addProductToCart(product)
  })
})
```

## üìä Estrutura de Arquivos Recomendada

```
cypress/
‚îú‚îÄ‚îÄ e2e/
‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login.cy.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logout.cy.js
‚îÇ   ‚îú‚îÄ‚îÄ shopping/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ add-to-cart.cy.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ checkout.cy.js
‚îÇ   ‚îî‚îÄ‚îÄ user/
‚îÇ       ‚îî‚îÄ‚îÄ profile.cy.js
‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îú‚îÄ‚îÄ common/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BasePage.js
‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LoginPage.js
‚îÇ   ‚îî‚îÄ‚îÄ shopping/
‚îÇ       ‚îú‚îÄ‚îÄ InventoryPage.js
‚îÇ       ‚îî‚îÄ‚îÄ CartPage.js
‚îú‚îÄ‚îÄ support/
‚îÇ   ‚îú‚îÄ‚îÄ commands.js
‚îÇ   ‚îî‚îÄ‚îÄ e2e.js
‚îî‚îÄ‚îÄ fixtures/
    ‚îî‚îÄ‚îÄ users.json
```

## üîÑ Page Object Base (Opcional)

```javascript
// pages/common/BasePage.js
class BasePage {
  visit(url) {
    cy.visit(url)
    return this
  }

  waitForPageLoad() {
    cy.get('body').should('be.visible')
    return this
  }

  getElementByTestId(testId) {
    return cy.get(`[data-test="${testId}"]`)
  }
}

export default BasePage
```

## üö¶ Como executar os testes

```bash
# Instalar depend√™ncias
npm install --save-dev cypress

# Executar testes
npx cypress open

# Executar em modo headless
npx cypress run

# Executar testes espec√≠ficos
npx cypress run --spec "cypress/e2e/login.cy.js"
```

## üìà Compara√ß√£o de Resultados

### Sem Page Objects:
- 50 linhas de c√≥digo duplicado
- 15 minutos para alterar um seletor
- Testes dif√≠ceis de entender

### Com Page Objects:
- 0 duplica√ß√£o de c√≥digo
- 2 minutos para alterar seletor
- Testes auto-explicativos

## üéì Pr√≥ximos Passos

- Implementar Page Objects em seus projetos existentes
- Criar comandos customizados para fluxos comuns
- Adicionar TypeScript para melhor intellisense
- Explorar padr√µes avan√ßados (Factory, Builder)

## üìû D√∫vidas?

Deixe suas d√∫vidas nos coment√°rios ou abra uma issue no GitHub!

---

**üìå Gostou do tutorial? Deixe uma ‚≠ê no reposit√≥rio e compartilhe com outros QAs!**

---

*Tutorial criado por [Seu Nome] - Conecte-se no [LinkedIn](seu-linkedin)*
